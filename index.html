<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Analog Clock with Runner</title>
  <style>
	button:nth-of-type(2) {
	  background: #333;
	  color: white;
	}

	button.icon-only {
	  padding: 10px 8px; /* compact spacing */
	  font-size: 18px;
	  background-color: #4a4a4a; /* slate gray */
	  color: white;
	  border: none;
	  border-radius: 6px;
	  cursor: pointer;
}
 
	.clock {
	  width: 300px;
	  height: 300px;
	  border: 8px solid #333;
	  border-radius: 50%;
	  position: relative;
	  background: white;
	  box-shadow:
	    inset 0 0 10px #ccc,
	    20px 20px 30px rgba(0, 0, 0, 0.4); /* ✅ Long diagonal shadow */
	}
	
	/* Glassy glare overlay */
	.clock::after {
	  content: '';
	  position: absolute;
	  top: 0; left: 0;
	  width: 100%; height: 100%;
	  border-radius: 50%;
	  background: radial-gradient(circle at top left, rgba(255,255,255,0.2), transparent 70%);
	  pointer-events: none;
	}
	
	.center {
	  width: 12px;
	  height: 12px;
	  background: radial-gradient(circle, #555 0%, #222 100%); /* ✅ Glossy center */
	  border-radius: 50%;
	  position: absolute;
	  top: 50%;
	  left: 50%;
	  transform: translate(-50%, -50%);
	  z-index: 10;
	  box-shadow: 4px 4px 6px rgba(0, 0, 0, 0.6); /* ✅ Diagonal dome shadow */
	}
	
	.hand {
	  position: absolute;
	  bottom: 50%;
	  left: 50%;
	  transform-origin: bottom center;
	  transform: translateX(-50%) rotate(0deg);
	  filter: drop-shadow(6px 6px 4px rgba(0, 0, 0, 0.5)); /* ✅ Tilted shadow */
	}
	
	.number {
	  position: absolute;
	  width: 30px;
	  height: 30px;
	  text-align: center;
	  line-height: 30px;
	  font-weight: bold;
	  color: #333;
	  transform: translate(-50%, -50%);
	  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3); /* ✅ Etched numbers */
	}

	body {
	  margin: 0;
	  background: #f0f0f0;
	  font-family: sans-serif;
	  height: 100vh;
	  width: 100vw;
	  position: relative;
	}

	.container {
	  position: absolute;
	  top: 10%;
	  left: 10%;
	  display: flex;
	  align-items: flex-start;
	}

    .clock {
      width: 300px;
      height: 300px;
      border: 8px solid #333;
      border-radius: 50%;
      position: relative;
      background: white;
    }

    .center {
      width: 12px;
      height: 12px;
      background: #333;
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }

    .hand {
      position: absolute;
      bottom: 50%;
      left: 50%;
      transform-origin: bottom center;
      transform: translateX(-50%) rotate(0deg);
    }

    .hour, .minute, .second {
      width: 0;
      height: 0;
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
    }

    .hour {
      border-bottom: 72px solid #333;
      z-index: 3;
    }

    .minute {
      border-bottom: 108px solid #333;
      z-index: 2;
    }

    .second {
      border-bottom: 132px solid red;
      z-index: 1;
      transition: transform 0.05s linear;
    }

    .number {
      position: absolute;
      width: 30px;
      height: 30px;
      text-align: center;
      line-height: 30px;
      font-weight: bold;
      color: #333;
      transform: translate(-50%, -50%);
    }

    .tick {
      position: absolute;
      width: 2px;
      height: 5px;
      background: #666;
      transform-origin: center;
    }

    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-left: 40px;
      position: relative;
      width: 200px;
    }

  .align-left {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    width: 100%;
    gap: 20px;
  }


	button {
	  padding: 10px 20px;
	  font-size: 16px;
	  background: #333;
	  color: white;
	  border: none;
	  border-radius: 6px;
	  cursor: pointer;
	  margin-bottom: 10px;
	}

    .status {
      font-weight: bold;
      color: #333;
      width: auto;
      text-align: left;
    }

	.status pre {
	  white-space: pre;               /* preserves exact formatting */
	  overflow-x: auto;               /* enables horizontal scroll for long lines */
	  font-family: monospace;
	  width: 100%;                    /* full container width */
	  max-width: none;                /* no artificial limit */
	  min-width: 1000px;
	  box-sizing: border-box;
	  padding: 10px;
	}

	.status pre.warning {
	  background: #f8d7da;
	  border-left: 4px solid #b00020;
	  border-radius: 4px;
	  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
	}

.runner-text {
  display: none; /* ✅ Hide by default */
  justify-content: center;
  gap: 5px;
  font-weight: bold;
  font-size: 24px;
  font-family: sans-serif;
  margin-top: 10px;
  flex-wrap: nowrap;       /* Prevent wrapping */
  white-space: nowrap;     /* Treat all spans as one line */
  overflow-x: hidden;      /* 🚫 Removes horizontal scrollbar */
  width: 100%;             /* Ensures full container width */
  box-sizing: border-box;  /* Prevents overflow from padding */
}


.runner-text span {
  display: inline-block;
  animation: slidePulse 3.5s ease-in-out infinite;
}

/* G goes first, then N... then R */

.runner-text span:nth-child(1)  { animation-delay: 1.7s; }
.runner-text span:nth-child(2)  { animation-delay: 1.6s; }
.runner-text span:nth-child(3)  { animation-delay: 1.5s; }
.runner-text span:nth-child(4)  { animation-delay: 1.4s; }
.runner-text span:nth-child(5)  { animation-delay: 1.3s; }
.runner-text span:nth-child(6)  { animation-delay: 1.2s; }
.runner-text span:nth-child(7)  { animation-delay: 1.1s; }
.runner-text span:nth-child(8)  { animation-delay: 1.0s; }
.runner-text span:nth-child(9)  { animation-delay: 0.9s; }
.runner-text span:nth-child(10) { animation-delay: 0.8s; }
.runner-text span:nth-child(11) { animation-delay: 0.7s; }
.runner-text span:nth-child(12) { animation-delay: 0.6s; }
.runner-text span:nth-child(13) { animation-delay: 0.5s; }
.runner-text span:nth-child(14) { animation-delay: 0.4s; }
.runner-text span:nth-child(15) { animation-delay: 0.3s; }
.runner-text span:nth-child(16) { animation-delay: 0.2s; }
.runner-text span:nth-child(17) { animation-delay: 0.1s; }
.runner-text span:nth-child(18) { animation-delay: 0s; }


@keyframes slidePulse {
  0%   { transform: translateX(0); }
  25%  { transform: translateX(10px); }
  50%  { transform: translateX(0); }
  75%  { transform: translateX(-10px); }
  100% { transform: translateX(0); }
}

    @media (max-width: 500px) {
      .container {
        flex-direction: column;
        align-items: center;
      }

      .clock {
        width: 250px;
        height: 250px;
      }

      .number, .tick {
        transform: translate(-50%, -50%);
      }

      .button-container {
        margin-left: 0;
        margin-top: 20px;
        width: auto;
      }
    }
	.check-button {
  padding: 10px 20px;
  font-size: 16px;
  min-width: 100px; /* or match Check 1's width */
  background-color: #333;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.check-input {
  padding: 10px 20px; /* match button padding */
  font-size: 16px;     /* match button font size */
  width: 50%;
  max-width: 100px;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box; /* ensures padding doesn't overflow */
}

.log-label {
  display: inline-block;
  color: #333;
  font-weight: normal;
  cursor: default;
  margin-top: 8px;
  text-decoration: none;
}

.log-label:hover {
  text-decoration: none;
  color: #333;
}


  </style>
</head>
<body>
  <div class="container">
    <div class="clock">
      <div class="hand hour" id="hour"></div>
      <div class="hand minute" id="minute"></div>
      <div class="hand second" id="second"></div>
      <div class="center"></div>
    </div>

    <div class="button-container">
      <div class="align-left">
		<div style="display: flex; gap: 10px;">
		  <button onclick="startProcess()">Check 1</button>
		  <button onclick="toggleFold()" class="icon-only">🕮</button>
		</div>
        <div class="status" id="status">
			<div id="trigger-msg"></div>
		</div>
		<div style="width: 100%">
			<div class="runner-text" id="runner">
			  <span>R</span><span>U</span><span>N</span><span>N</span><span>I</span><span>N</span><span>G</span>
			  <span>,</span><span>&nbsp;</span>
			  <span>W</span><span>A</span><span>I</span><span>T</span><span>&nbsp;</span>
			  <span>1</span><span>m</span><span>5</span><span>0</span><span>s</span>
			</div>
		</div>	
		<div style="display: flex; gap: 10px; margin-top: 10px;">
			<button onclick="startProcess2()">Check 2</button>
			<button onclick="toggleFold2()" class="icon-only">🕮</button>
		</div>
		<div id="status2" class="status"></div>
		<div style="width: 100%">
			<div class="runner-text" id="runner2">
			  <span>R</span><span>U</span><span>N</span><span>N</span><span>I</span><span>N</span><span>G</span><span>,</span>
			  <span>&nbsp;</span><span>W</span><span>A</span><span>I</span><span>T</span><span>&nbsp;</span>
			  <span>1</span><span>m</span><span>3</span><span>0</span><span>s</span>
			</div>
		</div>	
		<div style="display: flex; gap: 10px; margin-top: 10px; align-items: center;">
		  <button id="check3" class="check-button" onclick="startProcess3()">Check 3</button>
		  <input type="text" id="input3" class="check-input" style="transform: translateY(-5px);" placeholder="code" />
		</div>

      </div>
    </div>
  </div>

  <audio id="ding" src="https://www.soundjay.com/button/sounds/button-3.mp3" preload="auto"></audio>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    const clock = document.querySelector('.clock');

    // Add numbers
    const numberRadius = 135;
    for (let i = 1; i <= 12; i++) {
      const angle = (i * 30) * Math.PI / 180;
      const x = 150 + Math.sin(angle) * numberRadius;
      const y = 150 - Math.cos(angle) * numberRadius;
      const num = document.createElement('div');
      num.className = 'number';
      num.style.left = `${x}px`;
      num.style.top = `${y}px`;
      num.textContent = i;
      clock.appendChild(num);
    }

    // Add tick marks
    const tickCount = 60;
    const tickRadius = 145;
    for (let i = 0; i < tickCount; i++) {
      const angleDeg = i * 6;
      const angleRad = angleDeg * Math.PI / 180;
      const x = 150 + Math.sin(angleRad) * tickRadius;
      const y = 150 - Math.cos(angleRad) * tickRadius;
      const tick = document.createElement('div');
      tick.className = 'tick';
      tick.style.left = `${x}px`;
      tick.style.top = `${y}px`;
      tick.style.transform = `translate(-50%, -50%) rotate(${angleDeg}deg)`;
      clock.appendChild(tick);
    }

    // Clock animation
    let lastSec = 0;
    let rotationOffset = 0;

    function updateClock() {
      const now = new Date();
      const sec = now.getSeconds() + now.getMilliseconds() / 1000;
      const min = now.getMinutes() + sec / 60;
      const hr = now.getHours() % 12 + min / 60;

      if (sec < lastSec) {
        rotationOffset += 360;
      }
      lastSec = sec;

      const secDeg = sec * 6 + rotationOffset;
      const minDeg = min * 6;
      const hrDeg = hr * 30;

      document.getElementById('second').style.transform = `translateX(-50%) rotate(${secDeg}deg)`;
      document.getElementById('minute').style.transform = `translateX(-50%) rotate(${minDeg}deg)`;
      document.getElementById('hour').style.transform = `translateX(-50%) rotate(${hrDeg}deg)`;

      requestAnimationFrame(updateClock);
    }

    requestAnimationFrame(updateClock);

    // Button action
function startProcess() {
  let interval;
  const runner = document.getElementById('runner');
  const status = document.getElementById('status');
  const container = document.querySelector('.align-left');

  // Mark runner as active
  runner.setAttribute('data-running', 'true');
  runner.style.display = 'flex'; // Ensure it's visible immediately

  status.innerHTML = '<div id="trigger-msg">✅ Workflow triggered successfully</div>';

  let position = 0;
  let direction = 1;
  const maxPosition = container.offsetWidth - 40;

  // Trigger workflow
  fetch('https://repo1-qygx.onrender.com/trigger-workflow', {
    method: 'POST'
  })
    .then(res => res.json())
    .then(data => {
      const triggerMsg = document.getElementById('trigger-msg');
      if (triggerMsg) {
        triggerMsg.textContent = data.message || '✅ Workflow triggered successfully';

        setTimeout(() => {
          console.log('Showing runner now');
          runner.style.display = 'flex'; // Ensure flex layout for animation

          interval = setInterval(() => {
            position += direction * 5;
            if (position >= maxPosition || position <= 0) {
              direction *= -1;
            }
            runner.style.left = `${position}px`;
          }, 30);
        }, 200);
      }

      // Wait before fetching logs
      setTimeout(() => {
        fetch('https://repo1-qygx.onrender.com/logs/cypress')
          .then(res => res.json())
          .then(logData => {
            clearInterval(interval);
            runner.style.display = 'none';
            runner.setAttribute('data-running', 'false'); // Mark as completed

            const { log, warning } = extractRelevantLog(logData.logs);
            status.innerHTML = warning
              ? `<pre class="warning">${log}</pre>`
              : `<pre>${log}</pre>`;

            confetti({
              particleCount: 100,
              spread: 70,
              origin: { y: 0.6 }
            });

            document.getElementById('ding').play();
          })
          .catch(err => {
            clearInterval(interval);
            runner.style.display = 'none';
            runner.setAttribute('data-running', 'false'); // Mark as failed
            status.textContent = '❌ Error fetching logs';
            console.error(err);
          });
      }, 120000);
    })
    .catch(err => {
      clearInterval(interval);
      runner.style.display = 'none';
      runner.setAttribute('data-running', 'false'); // Mark as failed
      status.textContent = '❌ Error triggering workflow';
      console.error(err);
    });
}

	function extractRelevantLog(fullLog) {
	  const startMarker = 'My First Test';
	  const endMarker = '(Run Finished)';
	  const startIndex = fullLog.indexOf(startMarker);
	  const endIndex = fullLog.indexOf(endMarker);

	  if (startIndex !== -1 && endIndex !== -1 && endIndex > startIndex) {
		return {
		  log: fullLog.slice(startIndex, endIndex + endMarker.length),
		  warning: false
		};
	  }

	  return {
		log: fullLog,
		warning: true
	  };
	}

function toggleFold() {
  const status = document.getElementById('status');
  const runner = document.getElementById('runner');

  const hasContent = status.textContent.trim().length > 0;
  const isRunning = runner.getAttribute('data-running') === 'true';

  if (!hasContent) return;

  const isHidden = status.style.display === 'none';
  status.style.display = isHidden ? 'block' : 'none';

  runner.style.display = isHidden && isRunning ? 'flex' : 'none';
}


function startProcess2() {
  let interval;
  const runner = document.getElementById('runner2');
  const status = document.getElementById('status2');
  const container = document.querySelector('.align-left');

  // Mark runner as active
  runner.setAttribute('data-running', 'true');
  runner.style.display = 'flex';

  status.textContent = '⏳ Triggering Robot Tests...';

  fetch('https://repo1-qygx.onrender.com/trigger-robot-tests', {
    method: 'POST'
  })
    .then(res => res.json())
    .then(data => {
      status.textContent = data.status || '✅ Robot Tests workflow triggered';

      setTimeout(() => {
        let position = 0;
        let direction = 1;
        const maxPosition = container.offsetWidth - 40;

        interval = setInterval(() => {
          position += direction * 5;
          if (position >= maxPosition || position <= 0) {
            direction *= -1;
          }
          runner.style.left = `${position}px`;
        }, 30);
      }, 200);

      // Wait before fetching logs
      setTimeout(() => {
        fetch('https://repo1-qygx.onrender.com/logs/robot')
          .then(res => res.json())
          .then(logData => {
            clearInterval(interval);
            runner.style.display = 'none';
            runner.setAttribute('data-running', 'false'); // Mark as completed

            const { log, warning } = extractRelevantLog(logData.logs);

            if (warning) {
              status.innerHTML = `<pre class="warning">${log}</pre>`;
            } else {
              // Check if log.html is accessible and valid
              fetch('https://name.github.io/repo1/tmp/log.html')
                .then(logRes => logRes.text())
                .then(html => {
                  if (html.includes('Opening Robot Framework log failed')) {
                    status.innerHTML = `
                      <pre class="warning">
✅ Robot Test Completed, but log.html failed to load properly.
Please verify the log was generated correctly.
                      </pre>
                    `;
                  } else {
                    status.innerHTML = `
                      <p>✅ Robot Test Completed</p>
                      <div class="log-label" title="Robot Log">log.html</div>
                    `;
                  }
                })
                .catch(() => {
                  status.innerHTML = `
                    <pre class="warning">
✅ Robot Test Completed, but failed to verify log.html.
Check your network connection or try again later.
                    </pre>
                  `;
                });
            }

            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            document.getElementById('ding').play();
          })
          .catch(err => {
            clearInterval(interval);
            runner.style.display = 'none';
            runner.setAttribute('data-running', 'false'); // Mark as failed
            status.textContent = '❌ Error fetching Robot logs';
            console.error(err);
          });
      }, 110000); // Wait for Robot tests to complete
    })
    .catch(err => {
      clearInterval(interval);
      runner.style.display = 'none';
      runner.setAttribute('data-running', 'false'); // Mark as failed
      status.textContent = '❌ Error triggering Robot Tests';
      console.error(err);
    });
}


function toggleFold2() {
  const status = document.getElementById('status2');
  const runner = document.getElementById('runner2');

  const hasContent = status.textContent.trim().length > 0;
  const isRunning = runner.getAttribute('data-running') === 'true';

  if (!hasContent) return;

  const isHidden = status.style.display === 'none';
  status.style.display = isHidden ? 'block' : 'none';

  runner.style.display = isHidden && isRunning ? 'flex' : 'none';
}

	function startProcess3() {
	  // Placeholder for Check 3 logic
	}

  </script>
</body>
</html>





