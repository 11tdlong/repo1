<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Analog Clock with Runner</title>
  <style>
    body {
      margin: 0;
      background: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      font-family: sans-serif;
    }

    .container {
      display: flex;
      align-items: flex-start;
      position: relative;
    }

    .clock {
      width: 300px;
      height: 300px;
      border: 8px solid #333;
      border-radius: 50%;
      position: relative;
      background: white;
    }

    .center {
      width: 12px;
      height: 12px;
      background: #333;
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
    }

    .hand {
      position: absolute;
      bottom: 50%;
      left: 50%;
      transform-origin: bottom center;
      transform: translateX(-50%) rotate(0deg);
    }

    .hour, .minute, .second {
      width: 0;
      height: 0;
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
    }

    .hour {
      border-bottom: 72px solid #333;
      z-index: 3;
    }

    .minute {
      border-bottom: 108px solid #333;
      z-index: 2;
    }

    .second {
      border-bottom: 132px solid red;
      z-index: 1;
      transition: transform 0.05s linear;
    }

    .number {
      position: absolute;
      width: 30px;
      height: 30px;
      text-align: center;
      line-height: 30px;
      font-weight: bold;
      color: #333;
      transform: translate(-50%, -50%);
    }

    .tick {
      position: absolute;
      width: 2px;
      height: 5px;
      background: #666;
      transform-origin: center;
    }

    .button-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-left: 40px;
      position: relative;
      width: 200px;
    }

    .align-left {
      position: relative;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      background: #333;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 10px;
    }

    .status {
      font-weight: bold;
      color: #333;
      margin-top: 10px;
      height: auto;
      max-width: 100%;
    }

    .status pre {
      background: #eee;
      padding: 10px;
      border-radius: 6px;
      white-space: pre-wrap;
    }

    .runner {
      width: 40px;
      height: 40px;
      background: url('https://i.imgur.com/6o5Z5QG.gif') no-repeat center/contain;
      position: absolute;
      top: 60px;
      left: 0;
      display: none;
    }

    @media (max-width: 500px) {
      .container {
        flex-direction: column;
        align-items: center;
      }

      .clock {
        width: 250px;
        height: 250px;
      }

      .number, .tick {
        transform: translate(-50%, -50%);
      }

      .button-container {
        margin-left: 0;
        margin-top: 20px;
        width: auto;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="clock">
      <div class="hand hour" id="hour"></div>
      <div class="hand minute" id="minute"></div>
      <div class="hand second" id="second"></div>
      <div class="center"></div>
    </div>

    <div class="button-container">
      <div class="align-left">
        <button onclick="startProcess()">Check 1</button>
        <div class="status" id="status"></div>
        <div class="runner" id="runner"></div>
      </div>
    </div>
  </div>

  <audio id="ding" src="https://www.soundjay.com/button/sounds/button-3.mp3" preload="auto"></audio>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    const clock = document.querySelector('.clock');

    // Add numbers
    const numberRadius = 135;
    for (let i = 1; i <= 12; i++) {
      const angle = (i * 30) * Math.PI / 180;
      const x = 150 + Math.sin(angle) * numberRadius;
      const y = 150 - Math.cos(angle) * numberRadius;
      const num = document.createElement('div');
      num.className = 'number';
      num.style.left = `${x}px`;
      num.style.top = `${y}px`;
      num.textContent = i;
      clock.appendChild(num);
    }

    // Add tick marks
    const tickCount = 60;
    const tickRadius = 145;
    for (let i = 0; i < tickCount; i++) {
      const angleDeg = i * 6;
      const angleRad = angleDeg * Math.PI / 180;
      const x = 150 + Math.sin(angleRad) * tickRadius;
      const y = 150 - Math.cos(angleRad) * tickRadius;
      const tick = document.createElement('div');
      tick.className = 'tick';
      tick.style.left = `${x}px`;
      tick.style.top = `${y}px`;
      tick.style.transform = `translate(-50%, -50%) rotate(${angleDeg}deg)`;
      clock.appendChild(tick);
    }

    // Clock animation
    let lastSec = 0;
    let rotationOffset = 0;

    function updateClock() {
      const now = new Date();
      const sec = now.getSeconds() + now.getMilliseconds() / 1000;
      const min = now.getMinutes() + sec / 60;
      const hr = now.getHours() % 12 + min / 60;

      if (sec < lastSec) {
        rotationOffset += 360;
      }
      lastSec = sec;

      const secDeg = sec * 6 + rotationOffset;
      const minDeg = min * 6;
      const hrDeg = hr * 30;

      document.getElementById('second').style.transform = `translateX(-50%) rotate(${secDeg}deg)`;
      document.getElementById('minute').style.transform = `translateX(-50%) rotate(${minDeg}deg)`;
      document.getElementById('hour').style.transform = `translateX(-50%) rotate(${hrDeg}deg)`;

      requestAnimationFrame(updateClock);
    }

    requestAnimationFrame(updateClock);

    // Button action
    function startProcess() {
      const runner = document.getElementById('runner');
      const status = document.getElementById('status');
      const container = document.querySelector('.align-left');

      runner.style.display = 'block';
      status.textContent = '';

      let position = 0;
      let direction = 1;
      const maxPosition = container.offsetWidth - 40;

      const interval = setInterval(() => {
        position += direction * 5;
        if (position >= maxPosition || position <= 0) {
          direction *= -1;
        }
        runner.style.left = `${position}px`;
      }, 30);

      fetch('https://repo1-qygx.onrender.com/trigger-workflow', {
        method: 'POST'
      })
      .then(res => res.json())
      .then(data => {
        setTimeout(() => {
          clearInterval(interval);
          runner.style.display = 'none';
          status.innerHTML = `<pre>${data.logs || data.status || 'Done'}</pre>`;

          confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
          });

          document.getElementById('ding').play();
        }, 2000);
      })
      .catch(err => {
        clearInterval(interval);
        runner.style.display = 'none';
        status.textContent = 'Error triggering workflow';
        console.error(err);
      });
    }
  </script>
</body>
</html>
